<div :class="$style.top">
  <v-container :class="$style.container">
    <v-layout wrap align-center>
      <v-flex xs12>
        <source-select
          label="Target volume"
          :filterFunc="filterImages"
          bindToActiveSource
          hideIfOneDataset
          @input="setTargetVolume"
        />
      </v-flex>
    </v-layout>

    <v-card flat>
      <div :class="$style.heading">
        <span class="body-2">Tools</span>
      </div>
      <v-card-text :class="$style.tools">
        <v-btn-toggle v-model="activeToolIndex">
          <v-tooltip
            bottom
            v-for="tool in toolList"
            :key="tool.name"
          >
            <v-btn slot="activator" flat>
              <svg-icon :icon="tool.icon" :class="$style.toolIcon" />
            </v-btn>
            {{ tool.name }}
          </v-tooltip>
        </v-btn-toggle>
      </v-card-text>
    </v-card>

    <v-card flat>
      <div :class="$style.heading">
        <span class="body-2">Measurements</span>
      </div>
      <v-divider :class="$style.divider" />
      <div :class="$style.fullWidth">
        <template v-if="tools.length > 0">
          <template v-for="(tool,idx) in tools">
            <div :class="$style.row" :key="idx">
              <span :class="$style.rowAvatar">
                <svg-icon :icon="tool.toolInfo.icon" :class="$style.toolIcon" />
              </span>
              <div :class="$style.rowContent">
                <span :class="$style.rowContentName" :title="tool.name">
                  {{ tool.name || tool.toolInfo.name }}
                </span>
                <span :class="$style.rowContentDetails">
                  {{ tool.extraInfo }}
                </span>
              </div>
              <div :class="$style.action">
                <v-tooltip bottom>
                  <v-btn slot="activator" small icon>
                    <v-icon color="teal" @click="focusWidget(idx)">open_in_new</v-icon>
                  </v-btn>
                  Jump to slice
                </v-tooltip>
              </div>
              <div :class="$style.action">
                <pop-up>
                  <template v-slot:trigger>
                    <v-btn small icon>
                      <v-icon>more_vert</v-icon>
                    </v-btn>
                  </template>
                  <template v-slot:popup="{ close }">
                    <v-container grid-list-md :class="[$style.container, $style.popup]">
                      <v-layout wrap align-center>
                        <v-flex xs12>
                          <v-text-field
                            label="Name"
                            :placeholder="tool.toolInfo.name"
                            :value="tool.name"
                            @input="setToolName(idx, arguments[0])"
                          />
                        </v-flex>
                        <v-flex xs12>
                          <div>Tool color</div>
                          <palette-picker
                            :palette="palette"
                            :size="28"
                            :value="tool.color"
                            @input="setToolColor(idx, arguments[0])"
                          />
                        </v-flex>
                        <v-flex xs2>
                          <span class="body-1">Text Size</span>
                        </v-flex>
                        <v-flex xs7>
                          <v-slider
                            min="8"
                            max="32"
                            step="1"
                            dirty
                            :value="tool.size"
                            @input="setToolSize(idx, arguments[0])"
                          />
                        </v-flex>
                        <v-flex xs3>
                          <v-text-field
                            type="number"
                            min="8"
                            max="32"
                            step="1"
                            :value="tool.size"
                            @input="setToolSize(idx, arguments[0])"
                          />
                        </v-flex>
                      </v-layout>
                      <v-layout align-center>
                        <v-spacer />
                        <v-flex xs2>
                          <v-btn icon @click="deleteTool(idx); close()">
                            <v-icon color="red">delete</v-icon>
                          </v-btn>
                        </v-flex>
                        <v-flex xs2>
                          <v-btn icon @click="close">
                            <v-icon>close</v-icon>
                          </v-btn>
                        </v-flex>
                        <v-flex xs1 />
                      </v-layout>
                    </v-container>
                  </template>
                </pop-up>
              </div>
            </div>
            <v-divider :class="$style.divider" />
          </template>
        </template>
        <template v-else>
          <div class="body-1 teal--text text-xs-center">(none)</div>
        </template>
      </div>
    </v-card>
  </v-container>
</div>
